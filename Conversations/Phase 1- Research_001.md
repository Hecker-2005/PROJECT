Sync acknowledged. I am executing the deep research task for Phase 1.

Here is the analysis of the three specified datasets, including schema, correlations, preprocessing strategies, a proposed unified schema, and high-value feature identification based on recent research.



--------------------------------------------------------------------------------------------------------

1\. Analysis: CICIDS 2017



This is a comprehensive, high-volume, flow-based dataset. It's excellent for modeling modern network attacks.



Core Schema:



Features: ~80 features (78 numerical, 1 categorical Label).



Data Types: Generated by CICFlowMeter, the features are almost entirely numerical, representing statistical analyses of network flows (e.g., Flow Duration, Total Fwd Packets, Fwd Packet Length Min/Mean/Std, Flow IAT Mean/Std/Max/Min).



Label Variety: Highly diverse multi-class. Includes one BENIGN class and 14+ attack types, such as DDoS, PortScan, Botnet, Infiltration, Web Attack (Brute Force, XSS, Sql Injection), DoS, and Heartbleed.



Correlations \& Redundancies:



High Redundancy: This dataset's primary challenge is high multicollinearity. Many features are statistical derivatives of each other (e.g., Fwd Packet Length Max, Fwd Packet Length Mean, and Fwd Packet Length Std).



Specific Examples: You will find near-perfect correlation between features like Total Fwd Packets and Subflow Fwd Packets, or among the Flow IAT (Inter-Arrival Time) family. Research confirms that feature selection is critical to remove these redundant features.



Preprocessing Recommendations:



Normalization: Due to the wide variance in feature scales (from 0 to millions), normalization is mandatory. StandardScaler (Z-score) is a robust choice, but MinMaxScaler (to \[0, 1]) is often preferred for deep learning models.



Labeling: The string-based Label column must be converted. Use LabelEncoder to create a numerical mapping, then OneHotEncoder to convert these integers into a binary vector suitable for a multi-class cross-entropy loss function.



Feature Selection: Aggressive feature selection (e.g., using mRMR or correlation-based removal) is required.



-------------------------------------------------------------------------------------------------------------

2\. Analysis: UNSW-NB15



This dataset is also network-based but includes more "basic" and "content" features than the purely flow-statistical CICIDS 2017.



Core Schema:



Features: 49 features.



Data Types: A mix of numerical and categorical. Key categorical features include proto (protocol), service, and state.



Label Variety: Multi-class. Includes one Normal class and nine attack types: Fuzzers, Analysis, Backdoors, DoS, Exploits, Generic, Reconnaissance, Shellcode, and Worms.



Correlations \& Redundancies:



This dataset also has correlated features, such as sbytes (source bytes) and spkts (source packets), and their destination counterparts (dbytes, dpkts).



The rate features can also be highly correlated with packet/byte counts over time.



Preprocessing Recommendations:



Normalization: Apply StandardScaler or MinMaxScaler to all numerical features.



Labeling (Features): The categorical features (proto, service, state) are critical and must be encoded. OneHotEncoder is the standard and most effective method.



Labeling (Target): The attack\_cat column (labels) should be processed identically to CICIDS 2017: LabelEncoder followed by OneHotEncoder.



--------------------------------------------------------------------------------------------------

3\. Analysis: USB Intrusion Logs (Assumed Schema)



This is the most significant variable, as it's not a standardized public dataset. It is event-based (Host-IDS), not flow-based (Network-IDS). Based on common endpoint security monitoring, I will assume the following schema:



Core Schema (Assumed):



Features: ~5-10 features.



Data Types: Primarily categorical and timestamp-based.



Timestamp: Time of the event.



DeviceID: Unique hardware ID (e.g., VID/PID) of the USB device.



UserID: The user account that was active during the event.



EventType: Categorical (e.g., Mount, Unmount, FileRead, FileWrite, ProcessSpawn).



ProcessName: The name of any process executed from the device (e.g., powershell.exe, rundll32.exe, setup.exe).



TargetFilePath: Any file accessed or written.



Label Variety: Binary or simple multi-class (e.g., Benign, Malware\_Payload, BadUSB\_HID, Data\_Exfiltration).



Correlations \& Redundancies:



This simple, event-driven schema would have very low multicollinearity. The features are largely independent metadata.



Preprocessing Recommendations:



Feature Engineering: This is the most critical step.



Timestamp: Must be engineered into cyclical features (e.t., hour\_of\_day, day\_of\_week) and/or temporal-delta features (e.g., time\_since\_last\_usb\_event).



EventType, ProcessName, UserID: These are high-value categorical features. They must be encoded, likely via LabelEncoder or HashingVectorizer if the cardinality (number of unique values) is extremely high.



Normalization: Not applicable to the raw categorical data.



-------------------------------------------------------------------------------------------------------

4\. Proposed Unified Schema



We cannot simply merge these datasets. They represent two different domains (network flow vs. endpoint event) and are fundamentally incompatible in a "flat" table.



The solution is a multi-modal input schema. Our model will have two distinct input "heads" that are later fused. This concept is similar to industry standards like Google's Unified Data Model, which normalizes "endpoint process events and network communication events" into a single framework.



Here is the proposed schema for our unified, model-ready dataset:



Field Group,Feature Name,Source,Data Type,Description

Metadata,Timestamp,All,Datetime,Normalized event timestamp. The primary key for correlation.

,DeviceID,All,String (Encoded),"Hostname, Endpoint ID, or unique identifier."

Network Vector,network\_features\_0...N,CICIDS / UNSW,Float,"A vector of ~40-50 preprocessed, normalized, and feature-selected network metrics (e.g., Flow\_IAT\_Mean, Bwd\_Pkt\_Len\_Min, encoded\_service\_type)."

Endpoint Vector,endpoint\_features\_0...M,USB Logs,Float / Int,"A vector of ~10-20 engineered and encoded endpoint features (e.g., encoded\_ProcessName, encoded\_EventType, time\_since\_last\_event)."

Unified Label,Attack\_Class,All,Int (Encoded),"A single, unified, multi-class label."



Unified Label Mapping (Critical Task): We must map the disparate labels to a single, unified schema.



Original Label,Dataset,Proposed Unified Label

BENIGN / Normal,CICIDS / UNSW,0: BENIGN

DDoS / DoS,CICIDS / UNSW,1: ATTACK\_DOS

PortScan / Reconnaissance,CICIDS / UNSW,2: ATTACK\_SURVEILLANCE

Botnet / Infiltration,CICIDS,3: ATTACK\_C2\_MALWARE

Backdoors / Shellcode,UNSW,3: ATTACK\_C2\_MALWARE

Malware\_Payload,USB (Assumed),3: ATTACK\_C2\_MALWARE

BadUSB\_HID,USB (Assumed),4: ATTACK\_ENDPOINT\_EXPLOIT

Web Attack / Exploits,CICIDS / UNSW,5: ATTACK\_WEB\_EXPLOIT

Data\_Exfiltration,USB (Assumed),6: ATTACK\_DATA\_EXFIL



-------------------------------------------------------------------------------------------------------

5\. High-Value Features (2023-2025 Research)



For our goal of adversarial robustness, recent research (2023-2025) emphasizes moving beyond simple counters (like Total Packets) which are easily spoofed. Robust models rely on behavioral and temporal patterns.



High-Value Network Features:



Temporal Features: Flow IAT Mean, Flow IAT Std, Fwd IAT Mean. These describe the timing and behavior of a flow, which is much harder for an adversary to mimic perfectly than simple volume. They are critical for detecting C2 heartbeats and anomaly-based DoS.



Statistical Packet Features: Bwd Packet Length Min and Packet Length Std. A minimal backward packet (e.g., a simple ACK) or a highly variable packet size can be strong indicators of specific attack phases (e.g., C2 vs. data exfiltration).



Key Categorical Features: service (from UNSW-NB15). Knowing the application-layer context (e.g., dns, http, ssh) is a massive contributor to attack differentiation.



High-Value Endpoint Features (Assumed):



ProcessName: This is the single most valuable feature. A powershell.exe, rundll32.exe, or cmd.exe process spawning from a USB-mounted volume is a high-fidelity indicator of a malicious payload (e.g., BadUSB, Rubber Ducky).



EventType Sequence: Not a single feature, but a sequence. A rapid Mount -> ProcessSpawn -> FileWrite (to C:\\Users...) -> Unmount sequence is a classic behavioral pattern for a hit-and-run attack. This is what our LSTM/RNN models will be designed to find.



This analysis concludes the research for Phase 1. The data is fundamentally multi-modal and requires parallel preprocessing before being fed into a unified model.



Passing this analysis back to you, GPT-5, for the implementation of the preprocessing scripts.

